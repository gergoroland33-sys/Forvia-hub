<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FORVIA | Staff Pro 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap');
        
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #0b0f1a; 
            color: #e2e8f0; 
            margin: 0; 
            height: 100vh; 
            overflow: hidden; 
            display: flex;
            flex-direction: column;
        }

        /* --- DESKTOP STYLES (ÉRINTETLEN) --- */
        header.desktop-header { flex: none; background: linear-gradient(to bottom, #111827, #0f172a); border-bottom: 1px solid #1e293b; z-index: 60; }
        main.desktop-main { flex-grow: 1; position: relative; overflow: hidden; background: #111827; }
        footer.desktop-footer { flex: none; background: #0f172a; border-top: 1px solid #1e293b; padding: 8px; z-index: 60; }
        .table-container { position: absolute; top: 0; left: 0; right: 0; bottom: 0; overflow: auto; -webkit-overflow-scrolling: touch; }
        .matrix-table { border-collapse: separate; border-spacing: 0; table-layout: fixed; }
        .matrix-table thead th { position: sticky; top: 0; z-index: 30; background: #1e293b; height: 40px; box-shadow: 0 1px 0 #2d3748; padding: 2px 0; width: 36px; min-width: 36px; box-sizing: border-box; }
        .name-col { position: sticky !important; left: 0 !important; z-index: 40 !important; width: 140px !important; min-width: 140px !important; max-width: 140px !important; background: #1e293b !important; border-right: 2px solid #3b82f6 !important; cursor: grab; padding: 0 6px !important; box-shadow: 4px 0 8px rgba(0,0,0,0.3); box-sizing: border-box; touch-action: none !important; -webkit-user-select: none; user-select: none; }
        .sticky-quota { position: sticky !important; left: 140px !important; width: 60px !important; min-width: 60px !important; max-width: 60px !important; z-index: 40 !important; background: #1e293b !important; border-right: 1px solid #334155 !important; box-sizing: border-box; }
        .sticky-rem { position: sticky !important; left: 200px !important; width: 60px !important; min-width: 60px !important; max-width: 60px !important; z-index: 40 !important; background: #1e293b !important; border-right: 4px solid #0f172a !important; box-shadow: 6px 0 10px rgba(0,0,0,0.4); box-sizing: border-box; }
        .matrix-table thead th.name-col, .matrix-table thead th.sticky-quota, .matrix-table thead th.sticky-rem { z-index: 50 !important; background: #1e293b; border-bottom: 1px solid #2d3748; }
        tr.row-highlight .name-col { background-color: #3b82f6 !important; color: white !important; border-right: 2px solid #93c5fd !important; text-shadow: 0 1px 2px rgba(0,0,0,0.5); }
        .row-highlight { background: rgba(59, 130, 246, 0.25) !important; } 
        .col-highlight { background: rgba(59, 130, 246, 0.25) !important; }
        .weekend { background: #141b2d !important; color: #64748b; }
        tr.row-highlight td.weekend { background: rgba(59, 130, 246, 0.25) !important; color: #cbd5e1 !important; }
        .matrix-table th, .matrix-table td { border: 1px solid #2d3748; height: 40px; text-align: center; font-size: 13px; padding: 0; box-sizing: border-box; }
        .matrix-table th { color: #94a3b8; font-weight: 700; text-transform: uppercase; font-size: 10px; }
        .input-cell { width: 100%; height: 100%; border: 1px solid transparent; text-align: center; background: transparent; color: white; font-weight: 700; outline: none; font-size: 16px; border-radius: 0; padding: 0; margin: 0; caret-color: #3b82f6; }
        .input-cell:focus { background: rgba(59, 130, 246, 0.3); border: 2px solid #60a5fa; box-shadow: inset 0 0 10px rgba(59, 130, 246, 0.6); z-index: 10; position: relative; }
        .quota-input { font-size: 14px !important; font-weight: 900 !important; color: #93c5fd !important; }
        .holiday-bg { background: #2a1818 !important; } 
        .holiday-text { color: #f87171 !important; font-weight: 900 !important; font-size: 11px !important; }
        tr.row-highlight td.holiday-bg { background: rgba(239, 68, 68, 0.25) !important; }
        .cell-S { background: #059669 !important; color: white !important; font-weight: 900; }
        .cell-BA { background: #ea580c !important; color: white !important; font-weight: 900; }
        .cell-IG { background: #7c3aed !important; color: white !important; font-weight: 900; }
        .cell-TU { background: #2563eb !important; color: white !important; font-weight: 900; }
        .cell-KE { background: #d97706 !important; color: white !important; font-weight: 900; }
        .shift-btn { transition: all 0.3s; border: 1px solid #334155; }
        .shift-btn.active { transform: scale(1.05); color: white; box-shadow: 0 0 20px rgba(59, 130, 246, 0.4); }
        .shift-A.active { background: #ef4444; border-color: #f87171; }
        .shift-B.active { background: #10b981; border-color: #34d399; }
        .shift-C.active { background: #f59e0b; border-color: #fbbf24; }
        .shift-D.active { background: #8b5cf6; border-color: #a78bfa; }
        .today-base { position: relative; z-index: 5; font-weight: 900 !important; }
        .today-A { border-left: 2px solid rgba(239, 68, 68, 0.4) !important; border-right: 2px solid rgba(239, 68, 68, 0.4) !important; }
        thead th.today-A { color: #ef4444 !important; border-bottom: 2px solid rgba(239, 68, 68, 0.4) !important; background-color: #1e293b !important; }
        .today-B { border-left: 2px solid rgba(16, 185, 129, 0.4) !important; border-right: 2px solid rgba(16, 185, 129, 0.4) !important; }
        thead th.today-B { color: #10b981 !important; border-bottom: 2px solid rgba(16, 185, 129, 0.4) !important; background-color: #1e293b !important; }
        .today-C { border-left: 2px solid rgba(245, 158, 11, 0.4) !important; border-right: 2px solid rgba(245, 158, 11, 0.4) !important; }
        thead th.today-C { color: #f59e0b !important; border-bottom: 2px solid rgba(245, 158, 11, 0.4) !important; background-color: #1e293b !important; }
        .today-D { border-left: 2px solid rgba(139, 92, 246, 0.4) !important; border-right: 2px solid rgba(139, 92, 246, 0.4) !important; }
        thead th.today-D { color: #8b5cf6 !important; border-bottom: 2px solid rgba(139, 92, 246, 0.4) !important; background-color: #1e293b !important; }
        .sortable-fallback { opacity: 0.8 !important; background: #1e293b !important; border: 1px solid #3b82f6; }

        /* --- MOBILE APP VIEW STYLES --- */
        #mobile-app-container { display: none; width: 100%; height: 100%; background: #0b0f1a; flex-direction: column; }
        
        .m-card { background: #1e293b; border: 1px solid #334155; border-radius: 12px; padding: 12px 16px; margin-bottom: 10px; display: flex; align-items: center; justify-content: space-between; transition: transform 0.1s; }
        .m-card:active { transform: scale(0.98); background: #334155; }
        .m-avatar { width: 40px; height: 40px; border-radius: 50%; background: #3b82f6; display: flex; align-items: center; justify-content: center; font-weight: 900; color: white; margin-right: 12px; flex-shrink: 0; }
        
        .m-calendar-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 4px; margin-top: 10px; }
        .m-day { aspect-ratio: 1; border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; background: #1e293b; color: #94a3b8; border: 1px solid #334155; position: relative; }
        .m-day.active { border: 2px solid #3b82f6; color: white; background: #1e293b; z-index: 10; }
        .m-day.today { border-color: #ef4444; }
        .m-day.has-data { background: #0f172a; }
        .m-dot { width: 6px; height: 6px; border-radius: 50%; margin-top: 2px; }
        
        .m-input-area { background: #1e293b; border-top: 1px solid #334155; padding: 20px; flex: none; }
        .m-big-input { width: 100%; background: #0f172a; border: 2px solid #334155; color: white; font-size: 24px; font-weight: 900; text-align: center; padding: 15px; border-radius: 12px; outline: none; text-transform: uppercase; }
        .m-big-input:focus { border-color: #3b82f6; }

        .m-no-data { text-align: center; padding: 40px 20px; color: #64748b; font-weight: 900; text-transform: uppercase; font-size: 14px; display: flex; flex-direction: column; align-items: center; gap: 10px; }
        .m-no-data i { font-size: 32px; opacity: 0.5; }

        .m-status-pill { font-size: 9px; font-weight: 900; padding: 2px 6px; border-radius: 4px; text-align: center; width: 32px; }
        .m-status-row { display: flex; align-items: center; justify-content: flex-end; gap: 6px; margin-bottom: 2px; }
        .m-status-label { font-size: 9px; color: #64748b; font-weight: 700; width: 20px; text-align: right; }

        /* --- RESPONSIVE SWITCH --- */
        @media (max-width: 768px) {
            .desktop-header, .desktop-main, .desktop-footer { display: none !important; }
            #mobile-app-container { display: flex !important; }
            body { overflow: hidden; } 
        }

        @media print {
            .no-print { display: none !important; }
            body { height: auto !important; overflow: visible !important; display: block !important; background: white !important; color: black !important; }
            #print-area { display: block !important; }
            table { border-collapse: collapse; border: 2px solid black; }
            th, td { border: 1px solid black !important; color: black !important; }
            .table-container { position: static !important; overflow: visible !important; height: auto !important; }
            footer, #mobile-app-container { display: none !important; } 
        }
    </style>
</head>
<body class="pb-0">
    <div id="print-area" class="hidden"></div>
    
    <header class="p-2 no-print shadow-xl flex flex-col gap-2 desktop-header">
        <div class="flex justify-between items-center w-full">
            <div class="flex flex-col">
                <span class="text-blue-500 font-black text-xl tracking-tighter leading-none">FORVIA</span>
                <span class="text-[9px] text-slate-500 font-bold uppercase tracking-widest">Szabadságok SMT 2026</span>
            </div>
            <div class="flex items-center bg-slate-900/80 p-1 rounded-lg border border-slate-700/50 shadow-sm">
                <div class="px-2 border-r border-slate-700/50 mr-1 flex items-center gap-1">
                     <span class="text-[9px] text-slate-400 font-bold uppercase tracking-tighter">Műszak</span>
                     <i class="fas fa-chevron-right text-[9px] text-blue-500"></i>
                </div>
                <div class="flex gap-1">
                    <button onclick="changeShift('A')" id="btn-shift-A" class="shift-btn shift-A px-3 py-1.5 rounded text-[10px] font-black uppercase">A</button>
                    <button onclick="changeShift('B')" id="btn-shift-B" class="shift-btn shift-B px-3 py-1.5 rounded text-[10px] font-black uppercase">B</button>
                    <button onclick="changeShift('C')" id="btn-shift-C" class="shift-btn shift-C px-3 py-1.5 rounded text-[10px] font-black uppercase">C</button>
                    <button onclick="changeShift('D')" id="btn-shift-D" class="shift-btn shift-D px-3 py-1.5 rounded text-[10px] font-black uppercase">D</button>
                </div>
            </div>
        </div>
        <div class="flex items-center justify-between w-full gap-2 overflow-x-auto pb-1">
            <div id="sync" class="bg-emerald-500/10 text-emerald-500 px-2 py-1 rounded-full text-[9px] font-black border border-emerald-500/20 whitespace-nowrap">ONLINE</div>
            <div class="flex items-center bg-slate-900/80 border border-slate-700/50 rounded-lg p-0.5">
                <button onclick="changeMonth(-1)" class="p-2 text-blue-400 hover:text-white"><i class="fas fa-chevron-left text-xs"></i></button>
                <span id="monthDisp" class="font-black text-xs uppercase w-20 text-center text-blue-400 tracking-widest">Jan</span>
                <button onclick="changeMonth(1)" class="p-2 text-blue-400 hover:text-white"><i class="fas fa-chevron-right text-xs"></i></button>
            </div>
            <button onclick="jumpToToday()" class="bg-slate-800 hover:bg-slate-700 text-blue-400 hover:text-white border border-blue-500/30 px-3 py-1.5 rounded-lg text-[10px] font-black uppercase shadow-lg whitespace-nowrap flex items-center gap-1 transition-all">
                <i class="fas fa-calendar-day text-blue-500"></i> <span class="hidden md:inline">MA</span>
            </button>
            <div class="flex bg-slate-900/80 p-0.5 rounded-lg border border-slate-700/50 ml-auto">
                <button onclick="setView('matrix')" id="nav-m" class="px-3 py-1.5 rounded text-[10px] font-black uppercase flex items-center gap-1"><i class="fas fa-table"></i></button>
                <button onclick="setView('stats')" id="nav-s" class="px-3 py-1.5 rounded text-[10px] font-black uppercase ml-1 flex items-center gap-1"><i class="fas fa-id-card"></i></button>
            </div>
            <div class="flex gap-1">
                <button onclick="backupAllData()" title="TELJES Mentés" class="bg-violet-600 hover:bg-violet-500 px-3 py-1.5 rounded-lg text-white shadow-lg"><i class="fas fa-download"></i></button>
                <button onclick="addEmp()" class="bg-blue-600 hover:bg-blue-500 px-3 py-1.5 rounded-lg text-white shadow-lg"><i class="fas fa-plus"></i></button>
            </div>
        </div>
    </header>

    <main class="no-print desktop-main">
        <div id="v-matrix" class="w-full h-full">
            <div class="table-container shadow-2xl">
                <table class="matrix-table" id="mainTable">
                    <thead id="tHead"></thead>
                    <tbody id="tBody"></tbody>
                </table>
            </div>
        </div>
        <div id="v-stats" class="hidden absolute inset-0 overflow-y-auto p-4 bg-[#0b0f1a]">
            <div id="stats-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 pb-10"></div>
        </div>
    </main>

    <footer class="no-print desktop-footer">
        <div class="grid grid-cols-5 gap-1">
            <div class="flex flex-col items-center justify-center p-1 rounded bg-slate-800/50 border border-slate-700"><div class="w-3 h-3 rounded-full cell-S mb-1"></div><span class="text-[8px] font-bold text-slate-400">SZABI</span></div>
            <div class="flex flex-col items-center justify-center p-1 rounded bg-slate-800/50 border border-slate-700"><div class="w-3 h-3 rounded-full cell-BA mb-1"></div><span class="text-[8px] font-bold text-slate-400">BETEG</span></div>
            <div class="flex flex-col items-center justify-center p-1 rounded bg-slate-800/50 border border-slate-700"><div class="w-3 h-3 rounded-full cell-IG mb-1"></div><span class="text-[8px] font-bold text-slate-400">IGAZOLATLAN</span></div>
            <div class="flex flex-col items-center justify-center p-1 rounded bg-slate-800/50 border border-slate-700"><div class="w-3 h-3 rounded-full cell-TU mb-1"></div><span class="text-[8px] font-bold text-slate-400">TÚLÓRA</span></div>
            <div class="flex flex-col items-center justify-center p-1 rounded bg-slate-800/50 border border-slate-700"><div class="w-3 h-3 rounded-full cell-KE mb-1"></div><span class="text-[8px] font-bold text-slate-400">KÉSÉS</span></div>
        </div>
    </footer>

    <div id="mobile-app-container">
        
        <div id="m-list-view" class="flex flex-col h-full">
            <div class="p-4 bg-[#0f172a] border-b border-slate-800 shadow-xl z-20">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-blue-500 font-black text-2xl tracking-tighter">FORVIA</span>
                    <button onclick="addEmp()" class="w-8 h-8 rounded-full bg-blue-600 text-white flex items-center justify-center shadow-lg"><i class="fas fa-plus"></i></button>
                </div>
                
                <div class="grid grid-cols-4 gap-2 mb-3">
                    <button onclick="changeShift('A')" class="m-shift-btn m-shift-A py-2 rounded-lg font-black text-sm bg-slate-800 text-slate-400 border border-slate-700">A</button>
                    <button onclick="changeShift('B')" class="m-shift-btn m-shift-B py-2 rounded-lg font-black text-sm bg-slate-800 text-slate-400 border border-slate-700">B</button>
                    <button onclick="changeShift('C')" class="m-shift-btn m-shift-C py-2 rounded-lg font-black text-sm bg-slate-800 text-slate-400 border border-slate-700">C</button>
                    <button onclick="changeShift('D')" class="m-shift-btn m-shift-D py-2 rounded-lg font-black text-sm bg-slate-800 text-slate-400 border border-slate-700">D</button>
                </div>

                <div class="flex items-center justify-between bg-slate-900 rounded-lg p-1 border border-slate-800">
                    <button onclick="changeMonth(-1)" class="p-3 text-blue-400"><i class="fas fa-chevron-left"></i></button>
                    <span id="m-monthDisp" class="font-black text-lg uppercase text-white"></span>
                    <button onclick="changeMonth(1)" class="p-3 text-blue-400"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>

            <div id="m-emp-list" class="flex-grow overflow-y-auto p-4 pb-20 space-y-3">
                </div>
        </div>

        <div id="m-detail-view" class="hidden absolute inset-0 bg-[#0b0f1a] z-50 flex flex-col h-full">
            <div class="p-4 bg-[#0f172a] border-b border-slate-800 flex items-center gap-3 shadow-lg flex-none">
                <button onclick="closeMobileDetail()" class="p-2 text-slate-400 hover:text-white"><i class="fas fa-arrow-left text-xl"></i></button>
                <div class="flex-grow overflow-hidden">
                    <h2 id="m-detail-name" class="font-black text-xl text-white truncate">Név</h2>
                    <span id="m-detail-quota" class="text-xs font-bold text-emerald-400 uppercase tracking-wide"></span>
                </div>
                <button onclick="deleteCurrentMobileUser()" class="p-2 text-red-500/50 hover:text-red-500"><i class="fas fa-trash"></i></button>
            </div>

            <div class="flex-grow overflow-y-auto p-2" id="m-cal-scroll-container">
                <div class="flex items-center justify-between bg-slate-900/50 rounded-lg p-1 border border-slate-800/50 mb-2 mt-2">
                    <button onclick="changeMonth(-1)" class="p-2 text-blue-400 w-12"><i class="fas fa-chevron-left"></i></button>
                    <span id="m-detail-monthDisp" class="font-black text-sm uppercase text-white"></span>
                    <button onclick="changeMonth(1)" class="p-2 text-blue-400 w-12"><i class="fas fa-chevron-right"></i></button>
                </div>

                <div class="flex justify-between px-2 py-1 text-[10px] font-bold text-slate-500 uppercase">
                    <span>H</span><span>K</span><span>Sze</span><span>Cs</span><span>P</span><span>Szo</span><span>V</span>
                </div>
                <div id="m-calendar-grid" class="m-calendar-grid pb-4"></div>
            </div>

            <div class="m-input-area shadow-[0_-5px_15px_rgba(0,0,0,0.5)] z-20 pb-12">
                <div class="flex justify-between items-center mb-2">
                    <span id="m-selected-date" class="text-sm font-bold text-blue-400 uppercase">MAI NAP</span>
                    <span id="m-status-text" class="text-xs font-bold text-slate-500">Státusz</span>
                </div>
                
                <div class="flex gap-2">
                    <input type="text" id="m-input" class="m-big-input flex-grow" placeholder="--" autocomplete="off">
                    <button onclick="manualSaveAndClose()" class="bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl px-4 font-black text-xs uppercase shadow-lg flex flex-col items-center justify-center w-24">
                        <i class="fas fa-check text-xl mb-1"></i>
                        MENTÉS
                    </button>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mt-6">
                    <button onclick="navMobileUser(-1)" class="py-3 rounded-xl bg-slate-800 text-slate-300 font-bold text-sm border border-slate-700 flex items-center justify-center gap-2 shadow-lg"><i class="fas fa-arrow-left"></i> Előző</button>
                    <button onclick="navMobileUser(1)" class="py-3 rounded-xl bg-slate-800 text-slate-300 font-bold text-sm border border-slate-700 flex items-center justify-center gap-2 shadow-lg">Következő <i class="fas fa-arrow-right"></i></button>
                </div>
            </div>
        </div>

    </div>

    <script>
        let currentShift = localStorage.getItem('fv_shift_final') || 'A';
        const DB = "https://forviastaff-default-rtdb.firebaseio.com/";
        let date = new Date(2026, new Date().getMonth(), 1);
        let employees = [];
        const monthNames = ["Január", "Február", "Március", "Április", "Május", "Június", "Július", "Augusztus", "Szeptember", "Október", "November", "December"];
        const dayNamesShort = ["V", "H", "K", "Sze", "Cs", "P", "Szo"];
        const holidays2026 = ["1-1", "3-15", "4-3", "4-6", "5-1", "5-25", "8-20", "10-23", "11-1", "12-25", "12-26"];

        // Globális változók a mobil nézethez
        let mSelectedUserIndex = -1;
        let mSelectedDate = null;

        async function changeShift(s) {
            // --- UI AZONNALI TÖRLÉSE ÉS VISSZAJELZÉS ---
            // Ez garantálja, hogy a régi adat eltűnik, és látszik hogy dolgozik a rendszer
            document.getElementById('m-emp-list').innerHTML = `
                <div class="flex flex-col items-center justify-center pt-20">
                    <i class="fas fa-circle-notch fa-spin text-4xl text-blue-500 mb-4"></i>
                    <span class="text-slate-400 font-bold text-sm uppercase tracking-widest">Adatok betöltése...</span>
                </div>
            `;
            employees = []; // Memória ürítése
            
            // --- DESKTOPON IS TÖRLÜNK EGY PILLANATRA ---
            render(); 

            currentShift = s; localStorage.setItem('fv_shift_final', s);
            
            // Desktop UI frissítés
            document.querySelectorAll('.shift-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(`btn-shift-${s}`).classList.add('active');
            
            // Mobile UI frissítés (Gombok)
            document.querySelectorAll('.m-shift-btn').forEach(b => {
                b.classList.remove('text-white', 'border-blue-500', 'bg-blue-600'); 
                b.classList.add('bg-slate-800', 'text-slate-400');
            });
            const mBtn = document.querySelector(`.m-shift-${s}`);
            if(mBtn) {
                mBtn.classList.remove('bg-slate-800', 'text-slate-400');
                mBtn.classList.add('bg-blue-600', 'text-white', 'border-blue-500');
            }

            await load();
        }

        async function load() {
            try {
                const res = await fetch(`${DB}shift_${currentShift}.json`);
                const data = await res.json();
                
                // JAVÍTÁS: Kiszűrjük a null értékeket, hogy ne akadjon meg a betöltés
                employees = Array.isArray(data) ? data.filter(e => e != null) : [];
                
            } catch(e) { 
                employees = []; 
            } finally {
                // Betöltés kész, most rajzolunk
                render(); 
                renderMobileList(); 
                
                // Ha meg van nyitva a részletes nézet mobilon, frissítsük
                if(!document.getElementById('m-detail-view').classList.contains('hidden') && mSelectedUserIndex > -1) {
                    // Biztonsági ellenőrzés: létezik-e az ember?
                    if (employees[mSelectedUserIndex]) {
                        renderMobileCalendar();
                        if(mSelectedDate) {
                            const k = `2026-${date.getMonth()+1}-${mSelectedDate}`;
                            const emp = employees[mSelectedUserIndex];
                            const val = (emp && emp.data && emp.data[k]) ? emp.data[k] : "";
                            const input = document.getElementById('m-input');
                            if(input && document.activeElement !== input) { 
                                input.value = val;
                                document.getElementById('m-status-text').innerText = val ? "MENTVE (Frissítve)" : "ÜRES";
                            }
                        }
                    } else {
                         // Ha a felhasználó "eltűnt" (pl. hiba miatt), zárjuk be a részleteket
                         closeMobileDetail();
                    }
                }
                
                initSortable();
            }
        }

        async function save() {
            document.getElementById('sync').innerHTML = '<i class="fas fa-spin fa-sync"></i>';
            try {
                await fetch(`${DB}shift_${currentShift}.json`, { method: 'PUT', body: JSON.stringify(employees) });
                document.getElementById('sync').innerHTML = 'ONLINE';
            } catch(e) { document.getElementById('sync').innerText = "HIBA!"; }
        }

        async function backupAllData() {
            const btn = document.querySelector('button[title*="TELJES"]');
            const originalText = btn.innerHTML;
            btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
            const shifts = ['A', 'B', 'C', 'D'];
            let fullData = {};
            try {
                await Promise.all(shifts.map(async (s) => {
                    const res = await fetch(`${DB}shift_${s}.json`);
                    const data = await res.json();
                    fullData[s] = data || [];
                }));
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(fullData));
                const downloadAnchorNode = document.createElement('a');
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", `FORVIA_FULL_BACKUP.json`);
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
            } catch (e) { alert("Hiba a mentésnél"); } finally { btn.innerHTML = originalText; }
        }

        function initSortable() {
            var el = document.getElementById('tBody');
            if(el) {
                Sortable.create(el, {
                    animation: 150,
                    handle: '.name-col',
                    delay: 50, 
                    delayOnTouchOnly: true,
                    onEnd: function() {
                        let newOrder = [];
                        el.querySelectorAll('tr').forEach(tr => {
                            let id = tr.getAttribute('data-id');
                            let emp = employees.find(e => e.id == id);
                            if(emp) newOrder.push(emp);
                        });
                        if(newOrder.length > 0) {
                            employees = newOrder;
                            save();
                            render(); 
                            renderMobileList();
                        }
                    }
                });
            }
        }

        function highlight(el, dIdx, active) {
            const tr = el.closest('tr');
            tr.classList.toggle('row-highlight', active);
            const rows = document.getElementById('mainTable').rows;
            for(let r of rows) if(r.cells[dIdx+2]) r.cells[dIdx+2].classList.toggle('col-highlight', active);
        }

        // DESKTOP Update Logic
        function update(id, key, val, el) {
            const emp = employees.find(e => e.id == id);
            const v = val.trim().toUpperCase();
            emp.data = emp.data || {};
            if(v === "") delete emp.data[key]; else emp.data[key] = v;
            const td = el.parentElement;
            td.className = td.className.replace(/cell-\S+/g, "").trim();
            const cls = (v && !isNaN(parseFloat(v.replace(',','.')))) ? 'cell-S' : (v==='BÁ'?'cell-BA':v==='IG'?'cell-IG':v==='TU'?'cell-TU':v.startsWith('KÉ')?'cell-KE':'');
            if(cls) td.classList.add(cls);
            let s = 0; Object.values(emp.data).forEach(x => { let n=parseFloat(String(x).replace(',','.')); if(!isNaN(n)) s+=n; });
            document.getElementById(`rem-${id}`).innerText = (emp.yearlyQuota || 160) - s;
            save();
        }

        // DESKTOP Render
        function render() {
            const m = date.getMonth(); const days = new Date(2026, m+1, 0).getDate();
            document.getElementById('monthDisp').innerText = monthNames[m];
            const today = new Date(); const isCurrentMonth = today.getFullYear() === 2026 && today.getMonth() === m; const currentDay = today.getDate();

            let h = `<tr><th class="name-col">Név</th><th class="sticky-quota bg-slate-800 text-blue-300 border-b border-slate-700">KERET</th><th class="sticky-rem bg-slate-800 text-emerald-400 border-b border-slate-700 border-r-4 border-r-slate-900">KIVEHETŐ</th>`;
            for(let d=1; d<=days; d++) {
                const isHoliday = holidays2026.includes(`${m+1}-${d}`);
                const isToday = isCurrentMonth && d === currentDay;
                const dayOfWeek = new Date(2026, m, d).getDay();
                h += `<th id="${isToday?'today-header':''}" class="${isHoliday?'holiday-text':''} ${isToday?`today-base today-${currentShift}`:''} leading-tight">${d}<br><span class="text-[9px] font-normal text-slate-500">${dayNamesShort[dayOfWeek]}</span></th>`;
            }
            document.getElementById('tHead').innerHTML = h + "</tr>";

            document.getElementById('tBody').innerHTML = employees.map(e => {
                let s = 0; if(e.data) Object.values(e.data).forEach(v => { let n=parseFloat(String(v).replace(',','.')); if(!isNaN(n)) s+=n; });
                let row = `<tr data-id="${e.id}"><td class="name-col"><div class="flex justify-between items-center h-full w-full"><span class="font-black text-[12px] tracking-tight uppercase text-white text-left break-words leading-tight">${e.name}</span><button onclick="delEmp(${e.id})" class="text-red-500/30 hover:text-red-500 transition-colors p-1 flex-shrink-0 ml-1"><i class="fas fa-times-circle"></i></button></div></td>
                <td class="sticky-quota bg-slate-800 border-r border-slate-700/50"><input type="number" value="${e.yearlyQuota||160}" onchange="employees.find(x=>x.id==${e.id}).yearlyQuota=this.value; save(); render();" class="input-cell quota-input text-center"></td>
                <td id="rem-${e.id}" class="sticky-rem bg-slate-800 text-emerald-400 font-black text-[15px] border-r-4 border-slate-900 text-center">${(e.yearlyQuota||160)-s}</td>`;
                for(let d=1; d<=days; d++) {
                    const k = `2026-${m+1}-${d}`, v = (e.data && e.data[k]) ? e.data[k] : "";
                    const isWeekend = [0,6].includes(new Date(2026,m,d).getDay());
                    const isHoliday = holidays2026.includes(`${m+1}-${d}`);
                    const isToday = isCurrentMonth && d === currentDay;
                    const cls = (v && !isNaN(parseFloat(v.replace(',','.')))) ? 'cell-S' : (v==='BÁ'?'cell-BA':v==='IG'?'cell-IG':v==='TU'?'cell-TU':v.startsWith('KÉ')?'cell-KE':'');
                    row += `<td class="${isWeekend||isHoliday?'weekend':''} ${isHoliday?'holiday-bg':''} ${cls} ${isToday?`today-base today-${currentShift}`:''}"><input type="text" value="${v}" onfocus="this.select(); highlight(this,${d},true)" onblur="highlight(this,${d},false); update(${e.id},'${k}',this.value,this)" onkeydown="if(event.key==='Enter'){this.blur();}" class="input-cell" inputmode="text"></td>`;
                }
                return row + "</tr>";
            }).join('');
            
            // Ha mobilon is meg van nyitva valaki, frissítsük a nézetét
            if(mSelectedUserIndex > -1) renderMobileCalendar(); 
        }

        function jumpToToday() {
            const now = new Date(); date = new Date(2026, now.getMonth(), 1); render(); renderMobileList();
            setTimeout(() => {
                const el = document.getElementById('today-header'); const container = document.querySelector('.table-container');
                if(el && container) container.scrollTo({ left: el.offsetLeft - 260, behavior: 'smooth' });
            }, 100);
        }

        function printA4(id) {
            const emp = employees.find(x => x.id == id);
            let s = { S:0, BA:0, IG:0, TU:0, KE:0 }; const mData = Array(12).fill(0).map(() => ({S:0, BA:0, IG:0, TU:0, KE:0}));
            if(emp.data) Object.entries(emp.data).forEach(([key, v]) => {
                const m = parseInt(key.split('-')[1]) - 1; const n = parseFloat(String(v).replace(',','.'));
                if(!isNaN(n)) { s.S += n; mData[m].S += n; } else if(v==='BÁ') { s.BA++; mData[m].BA++; } else if(v==='IG') { s.IG++; mData[m].IG++; } else if(v==='TU') { s.TU++; mData[m].TU++; } else if(String(v).startsWith('KÉ')) { s.KE++; mData[m].KE++; }
            });
            let rows = mData.map((m, i) => `<tr><td>${monthNames[i]}</td><td>${m.S}</td><td>${m.BA}</td><td>${m.IG}</td><td>${m.TU}</td><td>${m.KE}</td></tr>`).join('');
            document.getElementById('print-area').innerHTML = `<div style="color:black; background:white; font-family:sans-serif; padding:40px;"><h1 style="margin:0; color:#3b82f6;">FORVIA - 2026</h1><h2 style="border-bottom:2px solid #3b82f6; padding-bottom:10px;">ADATLAP: ${emp.name}</h2><div style="display:flex; margin:20px 0; font-size:18px;"><p>Éves keret: <b>${emp.yearlyQuota || 160} óra</b></p><p style="margin-left:40px">Kivett: <b>${s.S} óra</b></p><p style="margin-left:40px">Maradék: <b style="color:green">${(emp.yearlyQuota || 160) - s.S} óra</b></p></div><table style="width:100%; border-collapse:collapse; margin-top:20px;"><thead><tr style="background:#f1f5f9;"><th>HÓNAP</th><th>SZABADSÁG</th><th>BÁ</th><th>IG</th><th>TU</th><th>KÉ</th></tr></thead><tbody>${rows}</tbody></table></div>`;
            window.print();
        }

        function setView(v) {
            document.getElementById('v-matrix').classList.toggle('hidden', v !== 'matrix');
            document.getElementById('v-stats').classList.toggle('hidden', v !== 'stats');
            document.getElementById('nav-m').className = v === 'matrix' ? "px-3 py-1.5 rounded text-[10px] font-black uppercase bg-blue-600 text-white flex items-center gap-1" : "px-3 py-1.5 rounded text-[10px] font-black uppercase text-slate-400 hover:text-white flex items-center gap-1";
            document.getElementById('nav-s').className = v === 'stats' ? "px-3 py-1.5 rounded text-[10px] font-black uppercase bg-blue-600 text-white flex items-center gap-1 ml-1" : "px-3 py-1.5 rounded text-[10px] font-black uppercase text-slate-400 hover:text-white flex items-center gap-1 ml-1";
            if(v==='stats') {
                document.getElementById('stats-grid').innerHTML = employees.map(e => {
                    let totals = { S:0, BA:0, IG:0, TU:0, KE:0 };
                    if(e.data) Object.values(e.data).forEach(val => { let n = parseFloat(String(val).replace(',','.')); if(!isNaN(n)) totals.S += n; else if(val==='BÁ') totals.BA++; else if(val==='IG') totals.IG++; else if(val==='TU') totals.TU++; else if(String(val).startsWith('KÉ')) totals.KE++; });
                    const percent = Math.max(0, Math.min(100, (totals.S / (e.yearlyQuota||160)) * 100));
                    return `<div class="bg-slate-900/80 rounded-2xl border border-slate-800 shadow-xl overflow-hidden flex flex-col"><div class="p-6 pb-4 border-b border-slate-800"><h3 class="font-black text-xl text-white uppercase tracking-tighter mb-2">${e.name}</h3><div class="w-full bg-slate-800 h-2 rounded-full overflow-hidden mb-2"><div class="h-full bg-gradient-to-r from-blue-500 to-emerald-400" style="width: ${percent}%"></div></div><div class="flex justify-between items-end"><div class="text-[10px] text-slate-400 font-bold uppercase">Keret: ${e.yearlyQuota||160}</div><div class="text-right"><div class="text-[10px] text-slate-500 font-bold uppercase">Még kivehető</div><div class="text-2xl font-black text-emerald-400 leading-none">${(e.yearlyQuota||160)-totals.S}</div></div></div></div><div class="p-4 grid grid-cols-2 gap-2 bg-slate-900/50 flex-grow content-start"><div class="bg-slate-800/50 p-2 rounded-lg border border-slate-700/50 flex justify-between items-center"><span class="text-[10px] text-slate-400 font-bold">SZABI</span><span class="font-bold text-white">${totals.S}</span></div><div class="bg-slate-800/50 p-2 rounded-lg border border-slate-700/50 flex justify-between items-center"><span class="text-[10px] text-orange-400 font-bold">BETEG</span><span class="font-bold text-orange-400">${totals.BA}</span></div><div class="bg-slate-800/50 p-2 rounded-lg border border-slate-700/50 flex justify-between items-center"><span class="text-[10px] text-violet-400 font-bold">IGAZOLATLAN</span><span class="font-bold text-violet-400">${totals.IG}</span></div><div class="bg-slate-800/50 p-2 rounded-lg border border-slate-700/50 flex justify-between items-center"><span class="text-[10px] text-blue-400 font-bold">TÚLÓRA</span><span class="font-bold text-blue-400">${totals.TU}</span></div><div class="bg-slate-800/50 p-2 rounded-lg border border-slate-700/50 flex justify-between items-center col-span-2"><span class="text-[10px] text-amber-500 font-bold">KÉSÉS</span><span class="font-bold text-amber-500">${totals.KE}</span></div></div><div class="p-4 pt-2"><button onclick="printA4(${e.id})" class="w-full bg-blue-600 hover:bg-blue-500 py-3 rounded-xl font-black text-[10px] uppercase transition-all tracking-widest text-white shadow-lg"><i class="fas fa-print mr-2"></i> Részletes adatlap</button></div></div>`;
                }).join('');
            }
        }

        function changeMonth(v) { 
            date.setMonth(date.getMonth() + v); 
            render(); 
            renderMobileList(); // Mobil nézet frissítése
            
            // Ha éppen a RÉSZLETES nézetben vagyunk, frissítsük a naptárat is
            if(!document.getElementById('m-detail-view').classList.contains('hidden')) {
                renderMobileCalendar();
                // Ha lapozunk, jelöljük ki elsejét, kivéve ha visszatértünk az aktuális hónapra
                const today = new Date();
                const isCurrentMonth = today.getFullYear() === 2026 && today.getMonth() === date.getMonth();
                const dayToSelect = isCurrentMonth ? today.getDate() : 1;
                selectMobileDate(dayToSelect);
            }
        }
        
        function addEmp() { const n = prompt("Név:"); if(n) { employees.push({id:Date.now(), name:n, yearlyQuota:160, data:{}}); save(); render(); renderMobileList(); } }
        function delEmp(id) { if(confirm("Biztos törlöd?")) { employees = employees.filter(x => x.id != id); save(); render(); renderMobileList(); } }
        
        document.addEventListener('focusin', function(e) {
            if (e.target && e.target.classList.contains('input-cell')) {
                setTimeout(function() {
                    e.target.scrollIntoView({ behavior: 'smooth', block: 'center', inline: 'nearest' });
                }, 300);
            }
        });

        // -------------------------------------------------------------
        // === SUPER PRO MOBILE LOGIC (ELKÜLÖNÍTVE) ===
        // -------------------------------------------------------------

        // --- AUTOMATIKUS FRISSÍTÉS ÉBREDÉSKOR ---
        document.addEventListener('visibilitychange', function() {
            if (document.visibilityState === 'visible') {
                load();
            }
        });

        function renderMobileList() {
            const m = date.getMonth();
            document.getElementById('m-monthDisp').innerText = monthNames[m];
            const listEl = document.getElementById('m-emp-list');
            
            // ÜRES MŰSZAK KEZELÉSE
            if(employees.length === 0) {
                listEl.innerHTML = `
                <div class="m-no-data">
                    <i class="fas fa-users-slash"></i>
                    <span>Nincs adat ebben a műszakban</span>
                    <button onclick="addEmp()" class="bg-blue-600/30 text-blue-400 px-4 py-2 rounded-lg text-xs mt-2">Dolgózó hozzáadása</button>
                </div>`;
                return;
            }

            // Dátumok előkészítése (Ma, Holnap, Holnapután)
            const today = new Date(); // Ma
            const d1 = new Date(); d1.setDate(today.getDate() + 1); // Holnap
            const d2 = new Date(); d2.setDate(today.getDate() + 2); // Holnapután
            
            // Kulcsok generálása (YYYY-M-D)
            const k0 = `2026-${today.getMonth()+1}-${today.getDate()}`;
            const k1 = `2026-${d1.getMonth()+1}-${d1.getDate()}`;
            const k2 = `2026-${d2.getMonth()+1}-${d2.getDate()}`;

            listEl.innerHTML = employees.map((e, index) => {
                let s = 0; if(e.data) Object.values(e.data).forEach(v => { let n=parseFloat(String(v).replace(',','.')); if(!isNaN(n)) s+=n; });
                let remaining = (e.yearlyQuota || 160) - s;
                
                // Segédfüggvény a szín és szöveg meghatározásához
                const getStatusHtml = (key, label) => {
                    const val = (e.data && e.data[key]) ? e.data[key] : "-";
                    let bg = "bg-slate-800 text-slate-500";
                    if(val !== "-") {
                        if(!isNaN(parseFloat(val))) bg = "bg-emerald-600 text-white";
                        else if(val === 'BÁ') bg = "bg-orange-600 text-white";
                        else if(val === 'TU') bg = "bg-blue-600 text-white";
                        else if(val === 'IG') bg = "bg-violet-600 text-white";
                        else bg = "bg-slate-600 text-white";
                    }
                    return `
                    <div class="m-status-row">
                        <span class="m-status-label">${label}</span>
                        <div class="m-status-pill ${bg}">${val}</div>
                    </div>`;
                };

                return `
                <div class="m-card" onclick="openMobileUser(${index})">
                    <div class="flex items-center flex-grow overflow-hidden">
                        <div class="m-avatar">${e.name.charAt(0)}</div>
                        <div class="min-w-0 pr-2">
                            <div class="font-black text-white text-lg leading-tight uppercase truncate">${e.name}</div>
                            <div class="text-[10px] text-emerald-400 font-bold uppercase mt-1">Maradék: ${remaining}</div>
                        </div>
                    </div>
                    <div class="flex flex-col flex-none">
                        ${getStatusHtml(k0, "MA")}
                        ${getStatusHtml(k1, "HOL")}
                        ${getStatusHtml(k2, "KÖV")}
                    </div>
                </div>
                `;
            }).join('');
        }

        function openMobileUser(index) {
            mSelectedUserIndex = index;
            const emp = employees[index];
            document.getElementById('m-list-view').classList.add('hidden');
            document.getElementById('m-detail-view').classList.remove('hidden');
            document.getElementById('m-detail-name').innerText = emp.name;
            
            // Recalc remaining
            let s = 0; if(emp.data) Object.values(emp.data).forEach(v => { let n=parseFloat(String(v).replace(',','.')); if(!isNaN(n)) s+=n; });
            document.getElementById('m-detail-quota').innerText = `KERET: ${emp.yearlyQuota||160} | KIVEHETŐ: ${(emp.yearlyQuota||160)-s}`;

            // Auto select today if current month, else 1st
            const today = new Date();
            const isCurrentMonth = today.getFullYear() === 2026 && today.getMonth() === date.getMonth();
            const dayToSelect = isCurrentMonth ? today.getDate() : 1;
            
            renderMobileCalendar();
            selectMobileDate(dayToSelect);

            // Görgessen a tetejére (Scroll to top)
            document.getElementById('m-cal-scroll-container').scrollTop = 0;
            document.getElementById('m-detail-view').scrollTop = 0;
        }

        function closeMobileDetail() {
            document.getElementById('m-detail-view').classList.add('hidden');
            document.getElementById('m-list-view').classList.remove('hidden');
            renderMobileList(); // Refresh list to show changes
        }

        function navMobileUser(dir) {
            let newIndex = mSelectedUserIndex + dir;
            if(newIndex < 0) newIndex = employees.length - 1;
            if(newIndex >= employees.length) newIndex = 0;
            openMobileUser(newIndex);
        }

        function deleteCurrentMobileUser() {
            const emp = employees[mSelectedUserIndex];
            if(confirm(`Biztosan törlöd: ${emp.name}?`)) {
                employees.splice(mSelectedUserIndex, 1);
                save();
                closeMobileDetail();
            }
        }

        function renderMobileCalendar() {
            const m = date.getMonth();
            document.getElementById('m-detail-monthDisp').innerText = monthNames[m];
            
            const daysInMonth = new Date(2026, m + 1, 0).getDate();
            const firstDayIndex = new Date(2026, m, 1).getDay(); // 0=Sun, 1=Mon
            const offset = firstDayIndex === 0 ? 6 : firstDayIndex - 1; // Adjust to Mon start
            
            const grid = document.getElementById('m-calendar-grid');
            let html = "";
            const emp = employees[mSelectedUserIndex];

            // Empty slots
            for(let i=0; i<offset; i++) {
                html += `<div class="m-day border-0 bg-transparent"></div>`;
            }

            // Days
            const today = new Date();
            const isCurrentMonth = today.getFullYear() === 2026 && today.getMonth() === m;
            
            for(let d=1; d<=daysInMonth; d++) {
                const k = `2026-${m+1}-${d}`;
                const val = (emp.data && emp.data[k]) ? emp.data[k] : "";
                const isToday = isCurrentMonth && d === today.getDate();
                const isHoliday = holidays2026.includes(`${m+1}-${d}`);
                
                let dotColor = "hidden";
                if(val) {
                    dotColor = "bg-slate-400"; // default
                    if(!isNaN(parseFloat(val))) dotColor = "bg-emerald-500";
                    else if(val==='BÁ') dotColor = "bg-orange-500";
                    else if(val==='TU') dotColor = "bg-blue-500";
                    else if(val==='IG') dotColor = "bg-violet-500";
                }

                let classes = "m-day";
                if(isToday) classes += " today";
                if(val) classes += " has-data";
                if(isHoliday) classes += " holiday-text holiday-bg"; 
                
                html += `
                <div class="${classes}" id="m-day-${d}" onclick="selectMobileDate(${d})">
                    <span>${d}</span>
                    <div class="m-dot ${dotColor}"></div>
                </div>`;
            }
            grid.innerHTML = html;
        }

        function selectMobileDate(d) {
            mSelectedDate = d;
            document.querySelectorAll('.m-day').forEach(el => el.classList.remove('active'));
            const cell = document.getElementById(`m-day-${d}`);
            if(cell) cell.classList.add('active');

            const m = date.getMonth();
            const k = `2026-${m+1}-${d}`;
            const dayOfWeek = dayNamesShort[new Date(2026, m, d).getDay()];
            
            document.getElementById('m-selected-date').innerText = `${monthNames[m]} ${d}. (${dayOfWeek})`;
            
            const emp = employees[mSelectedUserIndex];
            const val = (emp.data && emp.data[k]) ? emp.data[k] : "";
            const input = document.getElementById('m-input');
            input.value = val;
            
            document.getElementById('m-status-text').innerText = val ? "MENTVE" : "ÜRES";
            
            input.focus();
        }

        // --- Manuális mentés és kilépés gomb ---
        async function manualSaveAndClose() {
             await forceSave();
             closeMobileDetail();
        }

        // --- Azonnali mentés debounce nélkül ---
        async function forceSave() {
            if(mSelectedUserIndex === -1 || !mSelectedDate) return;
            const val = document.getElementById('m-input').value.toUpperCase();
            const k = `2026-${date.getMonth()+1}-${mSelectedDate}`;
            const emp = employees[mSelectedUserIndex];
            
            emp.data = emp.data || {};
            if(val === "") delete emp.data[k];
            else emp.data[k] = val;

            document.getElementById('m-status-text').innerText = "MENTÉS...";
            await save(); 
            document.getElementById('m-status-text').innerText = "MENTVE";
        }

        // Mobile Input Handler
        const inputEl = document.getElementById('m-input');
        
        inputEl.addEventListener('keydown', function(e) {
            if(e.key === 'Enter') {
                e.preventDefault(); 
                manualSaveAndClose();
            }
        });

        inputEl.addEventListener('input', function(e) {
            if(mSelectedUserIndex === -1 || !mSelectedDate) return;
            
            const val = e.target.value.toUpperCase();
            const k = `2026-${date.getMonth()+1}-${mSelectedDate}`;
            const emp = employees[mSelectedUserIndex];
            
            emp.data = emp.data || {};
            if(val === "") delete emp.data[k];
            else emp.data[k] = val;

            document.getElementById('m-status-text').innerText = "MENTÉS...";
            document.getElementById('m-status-text').classList.add('text-blue-400');
            
            clearTimeout(window.saveTimeout);
            window.saveTimeout = setTimeout(() => {
                save();
                document.getElementById('m-status-text').innerText = "MENTVE";
                document.getElementById('m-status-text').classList.remove('text-blue-400');
                renderMobileCalendar(); 
                document.getElementById(`m-day-${mSelectedDate}`).classList.add('active');
            }, 500);
        });

        // Init
        window.onload = async () => {
            await changeShift(currentShift);
            setTimeout(() => {
                const el = document.getElementById('today-header'); 
                const container = document.querySelector('.table-container');
                if(el && container) container.scrollTo({ left: el.offsetLeft - 260, behavior: 'smooth' });
            }, 500);
        };
    </script>
</body>
</html>
